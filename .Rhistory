diamonds_train_indices <- sample(1:nrow(diamonds2),0.8*nrow(diamonds2))
diamonds_train <- diamonds2 %>% slice(diamonds_train_indices)
diamonds_test <- diamonds2 %>% slice(-diamonds_train_indices)
# Fit the mod_diamonds2 on diamonds_train
mod_diamond2 <- lm(lprice ~ lcarat + color + cut + clarity, data = diamonds_train)
# Fit the mod_diamonds3 on diamonds_train
mod_diamond3 <- lm(lprice ~ depth + table + x + y + z + lcarat + color + cut + clarity,data=diamonds_train)
## add predictions to mod_diamond 2 and 3
model_dia_2 <- diamonds2 %>%
add_predictions(mod_diamond2, "pred2") %>% mutate(pred_price = pred2^2)
# rmse
sqrt(mean((model_dia_2$price - model_dia_2$pred_price)^2))
# Fit a regression tree using rpart
(regression_mod <- rpart(price ~ depth + table + x + y + z + lcarat + color + cut + clarity,data=diamonds_train))
diamonds2 <- diamonds %>%
filter(carat <= 2.5) %>%
mutate(lprice = log2(price), lcarat = log2(carat))
# 1)
# Splitting the data into test and train
diamonds_train_indices <- sample(1:nrow(diamonds2),0.8*nrow(diamonds2))
diamonds_train <- diamonds2 %>% slice(diamonds_train_indices)
diamonds_test <- diamonds2 %>% slice(-diamonds_train_indices)
# Fit the mod_diamonds2 on diamonds_train
mod_diamond2 <- lm(lprice ~ lcarat + color + cut + clarity, data = diamonds_train)
# Fit the mod_diamonds3 on diamonds_train
mod_diamond3 <- lm(lprice ~ depth + table + x + y + z + lcarat + color + cut + clarity,data=diamonds_train)
## add predictions to mod_diamond 2 and 3
model_dia_2 <- diamonds2 %>%
add_predictions(mod_diamond2, "pred2") %>% mutate(pred_price = pred2^2)
# rmse
sqrt(mean((model_dia_2$price - model_dia_2$pred_price)^2))
model_dia_3 <- diamonds2 %>%
add_predictions(mod_diamond3, "pred3") %>% mutate(pred_price = pred3^2)
# rmse
sqrt(mean((model_dia_3$price - model_dia_3$pred_price)^2))
# 2)
# Fit a regression tree using rpart
(regression_mod <- rpart(price ~ depth + table + x + y + z + lcarat + color + cut + clarity,data=diamonds_train))
# lcarat and y are the most important, with color being the least important
summary(regression_mod)
# As the model gets more complicated the rmse increases because it is overfitting
rmse(regression_mod,diamonds2_test) ## ~ 828.63
# 3)
# As the model gets more complicated the rmse increases because it is overfitting
rmse(regression_mod,diamonds_test) ## ~ 828.63
knitr::opts_chunk$set(echo = TRUE , dev = "png", dpi=300)
options(digits = 2)
library(readr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(stringr)
library(ggrepel)
library(reshape2)
library(corrgram)
library(tree)
library(rpart)
library(rpart.plot)
library(randomForest)
library(plotly)
set.seed(51)
setwd("~/Documents/Github/UberDataAnalysis")
knitr::opts_chunk$set(echo = TRUE , dev = "png", dpi=300)
options(digits = 2)
library(readr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(stringr)
library(ggrepel)
library(reshape2)
library(corrgram)
library(tree)
library(rpart)
library(rpart.plot)
library(randomForest)
library(plotly)
IMDB <- read.csv("IMDM_ratings.csv")
imdb <- IMDB[!duplicated(IMDB), ]
imdb <- imdb[!is.na(imdb$gross), ]
imdb <- imdb[!is.na(imdb$budget), ]
imdb <- subset(imdb, select = -c(aspect_ratio))
imdb <- subset(imdb, select = -c(color))
imdb <- subset(imdb, select = -c(movie_imdb_link))
imdb <- subset(imdb, select = -c(language))
# Cleaning the movie title by removing the special character "Â" at the end and some whitespaces.
imdb$movie_title <- gsub("Â", "", as.character(factor(imdb$movie_title)))
clean_title <- str_trim(imdb$movie_title, side = "right")
# Adding profit and ROI
imdb <- imdb %>% mutate(net_profit = gross - budget,return_on_investment = (net_profit/budget)*100)
# replacing all NA's with col average
imdb$facenumber_in_poster[is.na(imdb$facenumber_in_poster)] <- round(mean(imdb$facenumber_in_poster, na.rm = TRUE))
# replacing all 0's with NA's
imdb[,c(5,6,8,13,24,26)][imdb[,c(5,6,8,13,24,26)] == 0] <- NA
# replacing all NA's with col average
imdb$num_critic_for_reviews[is.na(imdb$num_critic_for_reviews)] <- round(mean(imdb$num_critic_for_reviews, na.rm = TRUE))
imdb$duration[is.na(imdb$duration)] <- round(mean(imdb$duration, na.rm = TRUE))
imdb$director_facebook_likes[is.na(imdb$director_facebook_likes)] <- round(mean(imdb$director_facebook_likes, na.rm = TRUE))
imdb$actor_3_facebook_likes[is.na(imdb$actor_3_facebook_likes)] <- round(mean(imdb$actor_3_facebook_likes, na.rm = TRUE))
imdb$actor_1_facebook_likes[is.na(imdb$actor_1_facebook_likes)] <- round(mean(imdb$actor_1_facebook_likes, na.rm = TRUE))
imdb$cast_total_facebook_likes[is.na(imdb$cast_total_facebook_likes)] <- round(mean(imdb$cast_total_facebook_likes, na.rm = TRUE))
imdb$actor_2_facebook_likes[is.na(imdb$actor_2_facebook_likes)] <- round(mean(imdb$actor_2_facebook_likes, na.rm = TRUE))
imdb$movie_facebook_likes[is.na(imdb$movie_facebook_likes)] <- round(mean(imdb$movie_facebook_likes, na.rm = TRUE))
# delete the blank cols in content rating as they cannot be replaced with anything reasonable
imdb <- imdb[!(imdb$content_rating %in% ""),]
# replacing all content_rating with mordern rating system
imdb$content_rating[imdb$content_rating == 'M']   <- 'PG'
imdb$content_rating[imdb$content_rating == 'GP']  <- 'PG'
imdb$content_rating[imdb$content_rating == 'X']   <- 'NC-17'
imdb$content_rating[imdb$content_rating == 'Approved']  <- 'R'
imdb$content_rating[imdb$content_rating == 'Not Rated'] <- 'R'
imdb$content_rating[imdb$content_rating == 'Passed']    <- 'R'
imdb$content_rating[imdb$content_rating == 'Unrated']   <- 'R'
imdb$content_rating <- factor(imdb$content_rating)
levels(imdb$country) <- c(levels(imdb$country), "Others")
imdb$country[(imdb$country != 'USA')&(imdb$country != 'UK')] <- 'Others'
imdb$country <- factor(imdb$country)
imdb <- imdb %>% mutate(grouped_score =
case_when(imdb_score < 4.0 ~ "bad",
imdb_score <= 6 ~ "ok",
imdb_score <= 8 ~ "good",
imdb_score <= 10 ~ "excellent")
)
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..)) +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")
imdb %>% group_by(imdb_score) %>% filter(imdb_score > 7.5) %>% count(imdb_score) %>% arrange(desc(n))
rating_imdb <- imdb %>% group_by(content_rating) %>%
filter(!is.na(content_rating)) %>%
summarise(average_imdb_score = mean(imdb_score), num = n())
ggplot(aes(x=average_imdb_score, y = num, label = content_rating),data = rating_imdb) +
geom_point() +
geom_label_repel()
imdb.directors <- data.frame (imdb %>%
group_by(director_name) %>%
summarise(count = n())%>%
filter(count >10, count <50))
ggplot(aes(x = director_name, y = count), data = imdb.directors)+
geom_jitter() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(title="Directors Distribution on Movies",x="Directors",y="Count of Movies")
avg_score_per_director <- data.frame (imdb %>%
group_by(director_name) %>%
mutate(count = n(),average_imdb_score = mean(imdb_score))%>%
filter(count >14, count <50))
ggplot(aes(x = director_name, y = average_imdb_score), data = avg_score_per_director)+
geom_point() +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(title="Average Imdb Score by Director",x="Directors",y="Average Imdb Score")
director_group <- group_by(imdb, director_name, genres)
movie_by_director <- summarise(director_group,
mean_score = mean(imdb_score))
movie_by_director <- movie_by_director[67:4530,]
movie_by_director <- movie_by_director[with(movie_by_director, order(-mean_score)), ]
movie_by_director <- head(movie_by_director, 20)
ggplot(aes(x = mean_score, y = director_name), data = movie_by_director) +
geom_point(aes(color = genres), size = 2) + xlab("Mean Score") +
ylab("Director Name")+ theme_minimal() + ggtitle('Director, Genres & Scores')
ggplot(imdb, aes(x =imdb_score, y =duration,colour = factor(imdb_score)))+
geom_point() +
labs(title = "Movie Duration and IMDB score",
x = "Imdb Score", y = "Duration")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter() +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
imdb_train_indices <- sample(1:nrow(imdb),0.8*nrow(imdb))
imdb_train <- imdb %>% slice(imdb_train_indices)
imdb_test <- imdb %>% slice(-imdb_train_indices)
# How is imdb score related to the num of voted users compared to duration
imdb_mod_1 = lm (imdb_score~ duration + director_facebook_likes + num_critic_for_reviews + budget,data=imdb_train)
summary(imdb_mod_1)
imdb_rf <-  randomForest(imdb_score ~ ., data=imdb_train,ntree = 100, importance = TRUE, do.trace = 10)
plot(imdb_rf)
importance <- importance(imdb_rf)
importance
varImportance <- data.frame(Variables = row.names(importance),
Importance = round(importance[ ,'IncNodePurity'],2))
# Create a rank variable based on importance
rankImportance <- varImportance %>%
mutate(Rank = paste0('#',dense_rank(desc(Importance))))
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity') +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'red') +
labs(x = 'Variables') +
coord_flip()
str(imdb)
imdb_mod_1 = lm (imdb_score~ duration + num_voted_users + num_critic_for_reviews + movie_facebook_likes,data=imdb_train)
summary(imdb_mod_1)
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity') +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'white') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity') +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'yellow') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity') +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'purple') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity') +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'yellow') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity',width=c2, fill = "#FF6666") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'white') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity',width=c2, fill = "#FF6666") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'yellow') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity', fill = "#FF6666") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'yellow') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity', fill = "#FF6666") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'black') +
labs(x = 'Variables') +
coord_flip()
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity', fill = "#f3ce13") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'black') +
labs(x = 'Variables') +
coord_flip()
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(fill = "#f3ce13") +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter() +
geom_smooth(fill = "#f3ce13") +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter() +
geom_smooth(data = All, fill = "#f3ce13") +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter() +
geom_smooth(aes(fill = "#f3ce13")) +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(aes(fill = "#f3ce13")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = 'skyblue') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '"#f3ce13"') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(aes(colour = '#f3ce13')) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(fill = '#f3ce13') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 22, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 24, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
geom_smooth(fill = 'black) +
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
scale_fill_manual(values=c("blue", "cyan4")) +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
scale_fill_manual('#f3ce13') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = imdb_score, y=net_profit/1000000 ), data = subset(imdb, net_profit > 1, !is.na(net_profit))) +
geom_jitter(shape = 21, fill = '#f3ce13') +
geom_smooth() +
labs(title = "Net Profit and IMDB score",
x = " Imdb Score", y = "Net Profit in $ Million")
ggplot(aes(x = director_name, y = average_imdb_score), data = avg_score_per_director)+
geom_point(colour="white") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(title="Average Imdb Score by Director",x="Directors",y="Average Imdb Score")
ggplot(aes(x = director_name, y = average_imdb_score), data = avg_score_per_director)+
geom_point(colour="#f3ce13") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(title="Average Imdb Score by Director",x="Directors",y="Average Imdb Score")
ggplot(aes(x = director_name, y = average_imdb_score), data = avg_score_per_director)+
geom_point(colour="black") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(title="Average Imdb Score by Director",x="Directors",y="Average Imdb Score")
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="black") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="#f3ce13",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "limegreen"))
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("*Imdb Score Distribution*") +
labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
install.packages('tikzDevice')
library(tikzDevice)
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(title = commonmark::markdown_latex("Resistance of Amoxicillin in *E. coli*")) +
labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
install.packages('commonmark')
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(title = commonmark::markdown_latex("Resistance of Amoxicillin in *E. coli*")) +
##labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(title = commonmark::markdown_latex("Imdb Score Distribution")) +
##labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
##ggtitle("Imdb Score Distribution") +
labs(title = commonmark::markdown_latex("Imdb Score Distribution"),x = "IMDB Score", y = "Count of Movies") +
theme(plot.title = element_text(color = "#f3ce13"))
knitr::opts_chunk$set(echo = TRUE , dev = "png", dpi=300)
options(digits = 2)
library(readr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(stringr)
library(ggrepel)
library(reshape2)
library(corrgram)
library(tree)
library(rpart)
library(rpart.plot)
library(randomForest)
library(plotly)
imdb <- subset(imdb, select = -c(grouped_score))
imdb_rf <-  randomForest(imdb_score ~ ., data=imdb_train,ntree = 100, importance = TRUE, do.trace = 10)
plot(imdb_rf)
importance <- importance(imdb_rf)
importance
varImportance <- data.frame(Variables = row.names(importance),
Importance = round(importance[ ,'IncNodePurity'],2))
# Create a rank variable based on importance
rankImportance <- varImportance %>%
mutate(Rank = paste0('#',dense_rank(desc(Importance))))
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity', fill = "#f3ce13") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'black') +
labs(x = 'Variables') +
coord_flip()
imdb_train <- subset(imdb, select = -c(grouped_score))
imdb_train <- subset(imdb_train, select = -c(grouped_score))
imdb_rf <-  randomForest(imdb_score ~ ., data=imdb_train,ntree = 100, importance = TRUE, do.trace = 10)
imdb_rf <-  randomForest(imdb_score ~ ., data=imdb_train,ntree = 100, importance = TRUE, do.trace = 10)
plot(imdb_rf)
plot(imdb_rf)
importance <- importance(imdb_rf)
importance
varImportance <- data.frame(Variables = row.names(importance),
Importance = round(importance[ ,'IncNodePurity'],2))
# Create a rank variable based on importance
rankImportance <- varImportance %>%
mutate(Rank = paste0('#',dense_rank(desc(Importance))))
# Use ggplot2 to visualize the relative importance of variables
ggplot(rankImportance, aes(x = reorder(Variables, Importance),
y = Importance, fill = Importance)) +
geom_bar(stat='identity', fill = "#f3ce13") +
geom_text(aes(x = Variables, y = 0.5, label = Rank),
hjust=0, vjust=0.55, size = 4, colour = 'black') +
labs(x = 'Variables') +
coord_flip()
rf.pred.valid <- predict(imdb_rf, valid)
rf.pred.valid <- predict(imdb_rf)
# generate confusion matrix for validation data
confusionMatrix(rf.pred.valid)
imdb_rf$confusionMatrix
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")+
theme(plot.title = element_text(color = "#f3ce13"))
ggplot(aes(x=imdb_score), data = imdb) +
geom_histogram(binwidth = 0.2,aes(fill = ..count..),colour="white",fill="#f3ce13") +
scale_x_continuous(breaks = 0:10) +
ggtitle("Imdb Score Distribution") +
labs(x = "IMDB Score", y = "Count of Movies")
